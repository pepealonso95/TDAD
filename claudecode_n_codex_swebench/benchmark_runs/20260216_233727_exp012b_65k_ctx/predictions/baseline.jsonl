{"instance_id": "astropy__astropy-12907", "model": "qwen-mini", "prediction": "diff --git a/astropy/modeling/separable.py b/astropy/modeling/separable.py\nindex a308e27297..0b734b20c5 100644\n--- a/astropy/modeling/separable.py\n+++ b/astropy/modeling/separable.py\n@@ -120,6 +120,13 @@ def _compute_n_outputs(left, right):\n     else:\n         lnout = left.shape[0]\n     if isinstance(right, Model):\n+        cright = _coord_matrix(right, \"right\", noutp)\n+    else:\n+        # When right is already a computed separability matrix (numpy array)\n+        cright = np.zeros((noutp, right.shape[1]))\n+        # The right matrix should be placed at the right side of the output\n+        # The shape of right is (n_outputs, n_inputs) for the right part\n+        cright[-right.shape[0]:, -right.shape[1]:] = right\n         rnout = right.n_outputs\n     else:\n         rnout = right.shape[0]\n@@ -239,6 +246,13 @@ def _cstack(left, right):\n         cleft = np.zeros((noutp, left.shape[1]))\n         cleft[: left.shape[0], : left.shape[1]] = left\n     if isinstance(right, Model):\n+        cright = _coord_matrix(right, \"right\", noutp)\n+    else:\n+        # When right is already a computed separability matrix (numpy array)\n+        cright = np.zeros((noutp, right.shape[1]))\n+        # The right matrix should be placed at the right side of the output\n+        # The shape of right is (n_outputs, n_inputs) for the right part\n+        cright[-right.shape[0]:, -right.shape[1]:] = right\n         cright = _coord_matrix(right, 'right', noutp)\n     else:\n         cright = np.zeros((noutp, right.shape[1]))\n"}
{"instance_id": "astropy__astropy-13033", "model": "qwen-mini", "prediction": ""}
{"instance_id": "astropy__astropy-13236", "model": "qwen-mini", "prediction": ""}
